(()=>{var t={714:()=>{function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,a){if(t){if("string"==typeof t)return e(t,a);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,a):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}!function(){"use strict";angular.module("RbsChangeApp").config(["$provide",function(e){e.decorator("RbsChange.ProductService",["$delegate","$window","$rootScope","GoogleGtmService",function(e,a,n,o){var r=e.addToCart;return e.addToCart=function(e,n){var i=r.apply(this,arguments);return angular.isDefined(a.dataLayer)&&i.then((function(e){var a=e.data.dataSets;if(a){var n=[];a.lines?n=a.lines:a.deliveries&&angular.forEach(a.deliveries,(function(e){var a;e.lines&&(a=n).push.apply(a,t(e.lines))})),angular.forEach(a.linesAdded,(function(t){var e=o.getLineByKey(n,t.key);angular.isObject(e)&&o.addProductCart(e,a.common.currencyCode)}))}})),i},e}])}])}()},297:()=>{!function(){"use strict";var t=angular.module("RbsChangeApp");t.directive("rbsCommerceProcess",["GoogleGtmService","$rootScope","$timeout",function(t,e,a){return{restrict:"A",link:function(n,o){n.deliveryAtHomeString="Achat en livraison",n.deliveryStoreString="Retrait en magasin",n.deliveryReservationString="RÃ©servation en magasin",n.deliveryRelayString="Achat en point relais",n.stepList=Object.values(n.steps),n.deliveryOption="",n.getFormattedStepName=function(t){return t},n.buildEcomTypeOption=function(t,e){return{step:t,stepName:n.getFormattedStepName(e)}},e.$on("analytics",(function(e,r){var i=function(){var e=r.label,a="";"paymentConnectorSelect"===e&&(e="confirm");var o="checkout",i=n.stepList.indexOf(e)+2;angular.isDefined(e)&&i>=2&&(t.setEvent(o),t.setEcomTypeOption(n.buildEcomTypeOption(i,e),o),t.setEncryptedCustomerEmail(n.cartData,o),t.addCartData(o),t.pushDataLayer(),4===i&&(angular.forEach(n.cartData.deliveries,(function(t,e){"atHome"===t.category?a=n.deliveryAtHomeString:"store"===t.category?a=n.deliveryStoreString:"reservation"===t.category?a=n.deliveryReservationString:"relay"===t.category&&(a=n.deliveryRelayString),e===n.cartData.deliveries.length-1?n.deliveryOption+=a:n.deliveryOption+=a+", "})),t.setCheckoutOption({step:i-1,option:n.deliveryOption})))};o.ready((function(){a((function(){window.Didomi?(window.didomiOnReady=window.didomiOnReady||[],window.didomiOnReady.push((function(){i()}))):i()}),500)}))}))}}}]),t.directive("layoutRbsCommerceCart",["GoogleGtmService","$window","$timeout",function(t,e,a){return{restrict:"A",link:function(n){a((function(){if(angular.isDefined(e.dataLayer)){var a="checkout";t.setEvent(a),t.setEcomTypeOption({step:1,stepName:"shopping bag"},a),t.setEncryptedCustomerEmail(n.cartData,a),t.addCartData(a),t.pushDataLayer()}}))}}}])}()},666:()=>{!function(){"use strict";angular.module("RbsChangeApp").directive("emakinaGtmGoogleTagManager",["GoogleGtmService","$rootScope","$location",function(t,e,a){return{restrict:"A",link:function(n,o){angular.element(document).ready((function(){o.data("sendCategoryPage")&&t.addPageCategory(),o.data("sendPageContextData")&&t.addPageContext(),t.trackCurrentPage(),a.search().failedReason&&t.purchaseFailed({deliveries:[t.getCartData()]},[a.search().failedReason]),e.$on("RbsWebsiteCookies:set",(function(){t.trackCurrentPage()}))}))}}}])}()},733:()=>{!function(){"use strict";var t=angular.module("RbsChangeApp");t.config(["$provide",function(t){t.decorator("rbsCatalogProductItemDirective",["$delegate","$timeout","$window","GoogleGtmService","RbsChange.ProductService",function(t,e,a,n,o){var r=t[0].link;return t[0].compile=function(){return function(i,c,s){r.apply(t[0],arguments);var u="",l=null,d={list:null};function g(t){e((function(){if(angular.isDefined(a.dataLayer))try{var e=o.extractURL(t);angular.isString(u)&&(d.list=i.$parent.blockProductList?i.$parent.blockProductList:u),angular.isNumber(t.position)&&(l=t.position),n.setEvent("productClick"),n.setEcomTypeOption(d,"click"),n.setProductData(t,"click",{position:l}),n.addCallback(e),n.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for product click",t)}}))}c.closest("[data-layout-rbs-catalog-product-list]").length>0?u="Product listing":c.closest("[data-layout-rbs-catalog-cross-selling]").length>0?u="Product Cross Selling":c.closest("[data-layout-rbs-catalog-cart-cross-selling]").length>0&&(u="Product Cart Cross Selling"),c.find("a").click((function(){g(i.productData)}))}},delete t[0].link,t}])}]),t.directive("gtmProductClicksV3",["GoogleGtmService","$window","$timeout","RbsChange.ProductService",function(t,e,a,n){return{restrict:"A",scope:{productsData:"@"},link:function(n,o){a((function(){if(angular.isDefined(e.dataLayer)){var r="Product Listing",i=null,c={list:null};o.find("a").on("click",(function(){var s;s=JSON.parse(n.productsData),a((function(){if(angular.isDefined(e.dataLayer))try{angular.isString(r)&&(c.list=n.$parent.blockProductList?n.$parent.blockProductList:r),angular.isNumber(s.position)?i=s.position:angular.isDefined(o.data("position"))&&(i=o.data("position")),t.setEvent("productClick"),t.setEcomTypeOption(c,"click"),t.setProductData(s,"click",{position:i}),t.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for product click",t)}}))}))}}))}}}])}()},318:()=>{!function(){"use strict";var t=angular.module("RbsChangeApp");t.directive("layoutRbsCatalogProductDetail",["GoogleGtmService","$window","$timeout",function(t,e,a){return{restrict:"A",link:function(n,o){a((function(){if(angular.isDefined(e.dataLayer)&&o.find("article.product-details").length>=1)try{t.setEvent("productDetailView"),t.setEcomOption({currencyCode:t.getCurrencyCode()}),t.setProductData(n.blockData,"detail"),t.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for product detail",t)}}))}}}]),t.directive("layoutRbsCatalogProduct",["GoogleGtmService","$window","$timeout",function(t,e,a){return{restrict:"A",link:function(n,o){a((function(){if(angular.isDefined(e.dataLayer)&&o.find("article.product-details").length>=1)try{t.setEvent("productDetailView"),t.setEcomOption({currencyCode:t.getCurrencyCode()}),t.setProductData(n.blockData,"detail"),t.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for product detail",t)}}))}}}])}()},740:()=>{!function(){"use strict";var t=angular.module("RbsChangeApp");function e(){var t=window.screen.width;return t>1200?"visible-lg-block":t>992?"visible-md-block":"visible-sm-block"}t.directive("layoutRbsCatalogCrossSelling",["GoogleGtmService","$window","$timeout",function(t,a,n){return{restrict:"A",link:function(o,r){o.productTileSelector=".product-list [data-rbs-catalog-product-item]",n((function(){if(angular.isDefined(a.dataLayer)){var n=r.find("."+e()+" "+o.productTileSelector);if(n.length>=1)try{t.setEvent("productImpressions"),t.setEcomOption({currencyCode:t.getCurrencyCode()});for(var i=0;i<n.length;i++){var c=o.blockData.productsData[i];c.position=i,t.setProductData(c,"impressions",{position:i,list:"Product Cross Selling"})}t.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for cross selling product list",t)}}}))}}}]),t.directive("layoutRbsCatalogCartCrossSelling",["GoogleGtmService","$window","$timeout",function(t,a,n){return{restrict:"A",link:function(o,r){o.productTileSelector=".product-list [data-rbs-catalog-product-item]",n((function(){if(angular.isDefined(a.dataLayer)){var n=r.find("."+e()+" "+o.productTileSelector);if(n.length>=1)try{t.setEvent("productImpressions"),t.setEcomOption({currencyCode:t.getCurrencyCode()});for(var i=0;i<n.length;i++){var c=o.blockData.productsData[i];c.position=i,t.setProductData(c,"impressions",{position:i,list:"Product Cart Cross Selling"})}t.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for cart cross selling product list",t)}}}))}}}]),t.directive("gtmCatalogProductsListV2",["RbsChange.AjaxAPI","$location","$rootScope","$anchorScroll","$timeout","$window","GoogleGtmService",function(t,e,a,n,o,r,i){return{restrict:"A",templateUrl:"/rbs-catalog-products-list-v2.twig",scope:{blockId:"=",blockParameters:"=",blockData:"=",blockProductList:"="},controller:["$scope","$element",function(c,s){var u=c.blockId;c.loading=!1;var l=0;c.paginationMode=s.attr("data-pagination-mode")||"default",c.useInfiniteScroll="infinite-scroll"===c.paginationMode,"true"===s.attr("data-use-infinite-scroll")&&(c.useInfiniteScroll=!0,c.paginationMode="infinite-scroll",console.warn("'data-use-infinite-scroll' attribute is deprecated since v4.3.0")),c.parameters=c.blockParameters,c.parameters.blockId=u;var d=c.blockData;function g(e){return c.context.pagination.offset=c.productsData.length,c.loading=!0,t.getData("Rbs/Catalog/Product/",c.contextData,c.context).then((function(t){c.pagination.count=t.data.pagination.count,t.data.pagination.offset===c.productsData.length&&(angular.forEach(t.data.items,(function(t){c.productsData.push(t)})),e&&C(t.data.items)),o((function(){c.loading=!1}))}),(function(){c.loading=!1}))}if(c.productsData=d.productsData,c.contextData=d.context.data,c.pagination=d.pagination,c.context={URLFormats:d.context.URLFormats,pagination:d.context.pagination,visualFormats:c.parameters.imageFormats,dataSetNames:c.parameters.dataSetNames,cacheTTL:c.parameters.tTL||c.parameters.TTL},c.sortBy=function(t){c.contextData.sortBy=c.parameters.sortBy=t,e.search("sortBy-"+u,t),c.context.pagination.offset=0,c.reload("sortBy")},c.updateOffset=function(a){t.openWaitingModal(),c.context.pagination.offset=a,t.getData("Rbs/Catalog/Product/",c.contextData,c.context).then((function(a){c.productsData=[],c.pagination=a.data.pagination,angular.forEach(a.data.items,(function(t){c.productsData.push(t)})),e.search("pageNumber-"+u,Math.floor(c.pagination.offset/c.pagination.limit)+1),t.closeWaitingModal(),o((function(){var t="top-"+c.blockId;e.hash()!==t&&e.hash(t),n(),C(a.data.items)}))}),(function(){c.productsData=[],t.closeWaitingModal()}))},a.$on("RbsElasticsearchFacetFilters",(function(t,e){e.facetFilters||(e.facetFilters=[]),c.contextData.facetFilters=e.facetFilters,c.contextData.searchText=e.searchText||null,c.contextData.webStoreStockFilter=e.webStoreStockFilter||null,c.contextData.storeStockFilter=e.storeStockFilter||null,c.context.pagination.offset=0,e.instantSearch?c.reload("instantSearch"):c.reload("facetFilters")})),a.$on("RbsElasticsearchSearchText",(function(t,e){!c.contextData.listId&&(e.reload=!1,c.contextData.searchText!==e.searchText&&(c.contextData.searchText=e.searchText||null,c.context.pagination.offset=0,e.instantSearch?c.reload("instantSearch"):c.reload("searchText")))})),c.reload=function(e){var a="instantSearch"!==e;a&&t.openWaitingModal(),t.getData("Rbs/Catalog/Product/",c.contextData,c.context).then((function(e){c.productsData=[],c.pagination=e.data.pagination,angular.forEach(e.data.items,(function(t){c.productsData.push(t)})),a&&t.closeWaitingModal()}),(function(){c.productsData=[],a&&t.closeWaitingModal()}))},c.addMoreProducts=function(){c.loading||("infinite-scroll"!==c.paginationMode&&"infinite-click"!==c.paginationMode||g(!0),"infinite-click"===c.paginationMode&&e.search("page-"+u,Math.floor(c.context.pagination.offset/c.context.pagination.limit)+1).replace())},("infinite-scroll"===c.paginationMode||"infinite-click"===c.paginationMode)&&c.pagination.pageCount>1){var m=!1,p=angular.element(r),f=e.search(),y=Math.min(f["page-"+u]||1,c.pagination.pageCount),h=f.position,v=(y-1)*c.context.pagination.limit;y&&function t(){return v>c.context.pagination.offset&&(g(!1).then((function(){t()||(jQuery("html, body").animate({scrollTop:h},1e3),D(),C(c.productsData))})),!0)}()||D(),1===y&&C(c.productsData)}function D(){p.on("scroll",(function(){m||(m=!0,o((function(){m=!1}),100),navigator.userAgent.match(/.+compatible; Google-Read-Aloud;.+/i)||e.search("position",p.scrollTop()).replace(),e.search("page-"+u,Math.floor(c.context.pagination.offset/c.context.pagination.limit)+1).replace(),c.$apply())}))}function C(t){o((function(){if(angular.isDefined(r.dataLayer)&&t.length>=1)try{i.setEvent("productImpressions"),i.setEcomOption({currencyCode:i.getCurrencyCode()});for(var e=0;e<t.length;e++)t[e].position=l,i.setProductData(t[e],"impressions",{list:c.blockProductList?c.blockProductList:"Product listing",position:l++});i.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for product list",t)}}))}"default"===c.paginationMode&&C(c.productsData)}],link:function(t,e,a){t.viewDetailTitleMask=a.viewDetailTitleMask||"PRODUCT_TITLE",t.scrollDisabled=function(){return"infinite-scroll"!==t.paginationMode||t.loading||t.productsData.length>=t.pagination.count}}}}]),t.config(["$provide",function(t){t.decorator("rbsCatalogProductsListV3Directive",["$delegate","$timeout","$window","GoogleGtmService","RbsChange.AjaxAPI","$location","$rootScope","$compile",function(t,e,a,n,o,r,i,c){return delete t[0].link,t[0].compile=function(){return function(t,s,u){var l=t.blockId;t.loading=!1,t.paginationMode=u.paginationMode||"default",t.parameters=t.blockParameters,t.parameters.blockId=l;var d=t.blockData,g=0;function m(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[],n=null;(n=t?s.find(".product-list-"+e+" [data-gtm-product-impressions-v3]"):s.find("[data-gtm-product-impressions-v3]")).length&&(angular.forEach(n,(function(t){a.push(JSON.parse($(t).attr("products-data")))})),v(a))}function p(){return t.loading=!0,h(t.contextData.parameters.pageNumber+1),o.reloadBlock(t.blockName,t.blockId,t.contextData.parameters,t.blockNavigationContext).then((function(a){f(a.data.dataSets.html,!1),e((function(){t.loading=!1,m(!0,t.contextData.parameters.pageNumber)}))}),(function(e){console.error("[rbsCatalogProductsListV3] error reloading block:",e),h(t.contextData.parameters.pageNumber-1),t.loading=!1}))}function f(e,a){var n="product-list-"+t.contextData.parameters.pageNumber,o=$(jQuery.parseHTML(e)).filter(".items").html();a?s.find(".product-list").html('<div class="'+n+'">'+o+"</div>"):s.find(".product-list").append('<div class="'+n+'">'+o+"</div>"),c(s.find("."+n))(t);var r=$(jQuery.parseHTML(e)).filter(".pagination").html();s.find(".pagination").html(r),c(s.find(".pagination"))(t)}if(t.contextData=d.context.data,t.contextData.layout={name:t.blockName,id:t.parameters.blockId},t.contextData.parameters=angular.copy(t.parameters),t.contextData.parameters.pageNumber=d.pagination.pageNumber,delete t.contextData.parameters.forceClassicPagination,t.context={URLFormats:d.context.URLFormats,visualFormats:t.parameters.imageFormats,dataSetNames:t.parameters.dataSetNames,cacheTTL:t.parameters.tTL||t.parameters.TTL},t.sortBy=function(e){t.contextData.parameters.sortBy=e,r.search("sortBy-"+l,e),h(1),t.reload("sortBy")},i.$on("RbsElasticsearchFacetFilters",(function(e,a){a.facetFilters||(a.facetFilters=[]),t.contextData.parameters.facetFilters=a.facetFilters,t.contextData.parameters.searchText=a.searchText||null,t.contextData.parameters.webStoreStockFilter=a.webStoreStockFilter||null,t.contextData.parameters.storeStockFilter=a.storeStockFilter||null,t.contextData.announcementData&&(t.contextData.parameters.decoratorId=a.decoratorId||0),h(1),t.reload(a.instantSearch?"instantSearch":"facetFilters")})),i.$on("RbsElasticsearchSearchText",(function(e,a){t.contextData.listId||void 0!==a.resultFunction&&t.contextData.resultFunction!==a.resultFunction||(a.redirect=!1,t.contextData.parameters.searchText!==a.searchText&&(t.contextData.parameters.searchText=a.searchText||null,h(1),t.reload(a.instantSearch?"instantSearch":"searchText")))})),t.reload=function(e){var a="instantSearch"!==e;a&&o.openWaitingModal();var n=o.reloadBlock(t.blockName,t.blockId,t.contextData.parameters,t.blockNavigationContext);return n.then((function(t){f(t.data.dataSets.html,!0),a&&o.closeWaitingModal()}),(function(t){console.error("[rbsCatalogProductsListV3] error reloading block:",t),a&&o.closeWaitingModal()})),n},t.onPaginationLinkClick=function(e){e.originalEvent.stopPropagation(),e.originalEvent.preventDefault(),t.changingPage||(t.changingPage=!0,"classic"===t.paginationMode&&(h(parseInt(e.target.getAttribute("data-page-number"),10)),t.reload().then((function(){t.changingPage=!1}),(function(){t.changingPage=!1}))))},t.addMoreProducts=function(){t.loading||"infinite-click"===t.paginationMode&&p()},"infinite-click"===t.paginationMode&&d.pagination.pageCount>1){var y=r.search();t.locationPageNumber=Math.min(y["page-"+l]||1,d.pagination.pageCount),t.locationPosition=y.position,function n(){if(t.locationPageNumber>t.contextData.parameters.pageNumber)p().then(n);else{u.noScrollAnimation?window.scrollTo(0,t.locationPosition):$("html, body").animate({scrollTop:t.locationPosition},1e3);var o=!1,i=angular.element(a);i.on("scroll",(function(){o||(o=!0,e((function(){o=!1}),500),navigator.userAgent.match(/.+compatible; Google-Read-Aloud;.+/i)||r.search("position",i.scrollTop()).replace(),t.$apply())}))}}()}function h(e){t.contextData.parameters.pageNumber=e;var a="classic"===t.paginationMode?"pageNumber":"page",n=t.contextData.parameters.pageNumber>1?t.contextData.parameters.pageNumber:null;r.search(a+"-"+l,n).replace()}function v(t){e((function(){if(angular.isDefined(a.dataLayer)&&t.length>=1)try{n.setEvent("productImpressions"),n.setEcomOption({currencyCode:n.getCurrencyCode()});for(var e=0;e<t.length;e++)t[e].position=g,n.setProductData(t[e],"impressions",{list:"Product listing",position:g++});n.pushDataLayer()}catch(t){console.error("Unable to push dataLayer for product list",t)}}))}m()}},t}])}])}()},681:()=>{!function(){"use strict";angular.module("RbsChangeApp").directive("layoutRbsCommercePaymentReturn",["GoogleGtmService","$timeout",function(t){return{restrict:"A",link:function(e){angular.element(document).ready((function(){var a=document.getElementById("google-tag-manager").dataset.sendPurchase;if(angular.isDefined(e.blockData)){var n=e.blockData.cart;if(n.payment.finalized){var o=[],r={id:e.blockParameters.transactionId.toString(),revenue:"0.0",tax:"0.0",shipping:0};angular.forEach(n.deliveries,(function(e){"reservation"===e.category?(t.setEvent("eReservation"),t.setCartData(e,"eReservation"),t.setEncryptedCustomerEmail(n,"eReservation"),t.setCustomerDataFromCart(n,e,"eReservation")):"1"!==a||"atHome"!==e.category&&"store"!==e.category&&"relay"!==e.category||(t.setEvent("purchase"),t.setCartData(e,"purchase"),t.setEncryptedCustomerEmail(n,"purchase"),t.setCustomerDataFromCart(n,e,"purchase"),t.setEcomOption({currencyCode:angular.isDefined(r.currency)?r.currency:t.getCurrencyCode()}),angular.isNumber(n.common.totalAmount)&&(r.revenue=n.common.totalAmount.toString()),angular.isNumber(n.common.totalTaxesAmount)&&(r.tax=n.common.totalTaxesAmount.toString()),angular.forEach(n.coupons,(function(t){o.push(t.code)})),o.length>0&&(r.coupon=o.join()),t.setEcomTypeOption(r,"purchase")),angular.forEach(e.modifiers,(function(t){!t.options.isForShipping||"fee"!==t.options.type&&"discount"!==t.options.type||(r.shipping+=t.amountWithTaxes)}))})),r.shipping=r.shipping.toString(),t.pushDataLayer()}else t.purchaseFailed(n,["Error transaction status"])}}))}}}])}()},353:()=>{!function(){"use strict";angular.module("RbsChangeApp").config(["$provide",function(t){t.decorator("rbsCommerceShortCartDirective",["$delegate","$window","RbsChange.AjaxAPI","GoogleGtmService",function(t,e,a,n){var o=t[0].link;return t[0].compile=function(){return function(r,i,c){o.apply(t[0],arguments);var s={detailed:!1,URLFormats:"canonical",visualFormats:r.parameters.imageFormats};function u(t){if(!t)return r.readOnly=!1,void(r.cartData=t);if(r.readOnly=t.processData.locked,!t.amounts){var e=r.parameters&&r.parameters.displayPricesWithTax,a=r.parameters&&r.parameters.displayPricesWithoutTax;(e||a)&&(t.amounts=e?{linesAmountWithTaxes:0}:{linesAmountWithoutTaxes:0},angular.forEach(t.deliveries,(function(a){e?t.amounts.linesAmountWithTaxes+=a.linesAmountWithTaxes:t.amounts.linesAmountWithoutTaxes+=a.linesAmountWithoutTaxes})))}t.lines||(t.lines=[],angular.forEach(t.deliveries,(function(e){angular.forEach(e.lines,(function(e){t.lines.push(e)}))}))),r.cartData=t}function l(t){r.loading=!0,a.openWaitingModal(c.deleteProductWaitingMessage);var e=a.putData("Rbs/Commerce/Cart/Lines",{lines:t},s);return e.then((function(t){var e=t.data.dataSets;e&&!angular.isArray(e)&&u(e),i.find(".dropdown-toggle").dropdown("toggle"),r.loading=!1,a.closeWaitingModal()}),(function(t){console.error("updateCartData",t),r.loading=!1,a.closeWaitingModal()})),e}r.updateLineQuantity=function(t,a){if(angular.isDefined(e.dataLayer)){var o=n.getLineByKey(r.cartData.lines,t);o.quantity>a?(o.quantity=o.quantity-a,n.removeProductCart(o)):o.quantity<a&&(o.quantity=a-o.quantity,n.addProductCart(o,r.cartData.common.currencyCode))}l([{key:t,quantity:a}])}}},delete t[0].link,t}]),t.decorator("rbsCommerceCartLineDefaultDirective",["$delegate","$window","$rootScope","GoogleGtmService",function(t,e,a,n){var o=t[0].link;return t[0].compile=function(){return function(a,r,i,c){o.apply(t[0],arguments);var s=c[0]||c[1];a.updateQuantity=function(){angular.isDefined(e.dataLayer)&&(a.line.quantity>a.quantity?(a.line.quantity-=a.quantity,n.removeProductCart(a.line)):a.line.quantity<a.quantity&&(a.line.quantity=a.quantity-a.line.quantity,n.addProductCart(a.line,a.currencyCode))),s.updateCartLinesData([{key:a.line.key,quantity:a.quantity}])},a.remove=function(){angular.isDefined(e.dataLayer)&&n.removeProductCart(a.line),s.updateCartLinesData([{key:a.line.key,quantity:0}])}}},delete t[0].link,t}])}])}()},579:()=>{!function(){"use strict";angular.module("RbsChangeApp").directive("emakinaGtmSearchTerms",["GoogleGtmService",function(t){return{restrict:"A",link:function(e,a){e.init=function(){var e=$(a).data("terms");t.setEvent("SearchView"),t.addVars("SearchTerms",e),t.pushDataLayer()},a.ready((function(){e.init()}))}}}])}()},440:()=>{function t(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}!function(){"use strict";angular.module("RbsChangeApp").provider("GoogleGtmService",(function(){var a,n="rbsWebsiteTrackerConsentGdpr",o=!1,r=null,i=null,c=!1,s=!1,u=!1,l=0;function d(){return"trackersAskConsent"}function g(){return u}function m(){return i}function p(){return a}function f(){return c}function y(){return s}function h(t){u=t}function v(t){c=t}function D(t){s=t}this.$get=["$window","RbsChange.Cookies","RbsChange.AjaxAPI",function(c,u,C){function b(t,e){a[t]=e}function S(t,e){"impressions"===t&&angular.isUndefined(a.ecommerce.impressions)&&(a.ecommerce.impressions=[]),angular.isUndefined(a.ecommerce[t])&&(a.ecommerce[t]={}),"impressions"!==t&&e&&angular.isUndefined(a.ecommerce[t].products)&&(a.ecommerce[t].products=[])}function k(){var t=C.globalVar("cartData");if(!angular.isUndefined(t))return t;var e=C.getBlockParameters("cartData");if(angular.isObject(e)&&e.length>0){var a={detailed:!1,URLFormats:"canonical",visualFormats:e.imageFormats};C.getData("Rbs/Commerce/Cart",null,a).then((function(e){var a=e.data.dataSets;if(angular.isObject(a))return t}),(function(t){console.error("loadCurrentCart",t)}))}}function x(){return angular.isDefined(__change.navigationContext)&&angular.isDefined(__change.navigationContext.currency)?__change.navigationContext.currency:"EUR"}function P(){return l++}function L(t){var e="undefined";try{angular.isDefined(t.common)?e=t.common.brand.common.title:angular.isDefined(t.options)&&(e=t.options.brand.label)}catch(t){console.error("Product brand is missing",t),o=!1}return e}function T(){s||null!==i&&(function(t,e,a,n,o){t[n]=t[n]||[],t[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var r=e.getElementsByTagName(a)[0],i=e.createElement(a);i.async=!0,i.src="//www.googletagmanager.com/gtm.js?id="+o,r.parentNode.insertBefore(i,r)}(window,document,"script","dataLayer",i),s=!0)}function w(){angular.isString(a.event)&&a.event.length>0&&!o&&(c.dataLayer=c.dataLayer||[]).push(a),a=E()}function E(){return l=0,{event:"",ecommerce:{}}}function A(t){a.ecommerce=Object.assign({},a.ecommerce,t)}function R(t,e){S(e,!1),a.ecommerce[e].actionField=t}function $(t){a.event=t}function I(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(angular.isDefined(t.designation)&&angular.isDefined(t.options.productId)){S(e,!0);var o={name:t.designation,id:t.options.productId.toString()};angular.isDefined(t.amountWithTaxes)&&(o.price=t.amountWithTaxes.toString());var r=L(t);angular.isDefined(r)&&(o.brand=r),angular.isDefined(t.quantity)&&(o.quantity=t.quantity),angular.isDefined(t.coupon)&&(o.coupon=t.coupon),angular.isDefined(n.position)&&(o.position=n.position),angular.isDefined(n.list)&&(o.list=n.list),"impressions"===e?a.ecommerce.impressions[P()]=o:a.ecommerce[e].products.push(o)}}function U(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(angular.isDefined(t.common.title)&&angular.isDefined(t.common.id)){S(e,!0);var o={name:t.common.title,id:t.common.id.toString()};angular.isDefined(t.price.valueWithTax)&&(o.price=t.price.valueWithTax.toString());var r=L(t);angular.isDefined(r)&&(o.brand=r),angular.isDefined(t.quantity)&&(o.quantity=t.quantity),angular.isDefined(t.coupon)&&(o.coupon=t.coupon),angular.isDefined(n.position)&&(o.position=n.position),angular.isDefined(n.list)&&(o.list=n.list),angular.isDefined(t.stock.sku)&&(o.sku=t.stock.sku),angular.isDefined(t.common.family)&&(o.parentCategory=t.common.family),angular.isDefined(t.common.subfamily)&&(o.category=t.common.subfamily),angular.isDefined(t.common.color)&&(o.couleur=t.common.color),angular.isDefined(t.common.reference)&&(o.variant=t.common.reference),angular.isDefined(t.common.MOD_05)&&(o.last=t.common.MOD_05),"impressions"===e?a.ecommerce.impressions[P()]=o:a.ecommerce[e].products.push(o)}}function F(){var t,a=window.location.href,n=function(t,a){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=e(t))){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,i=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}(new URLSearchParams(a));try{for(n.s();!(t=n.n()).done;){var o=t.value;o[0].includes("utm")&&b(o[0],o[1])}}catch(t){n.e(t)}finally{n.f()}}function M(t){return{common:{id:angular.isDefined(t.product.common.id)?t.product.common.id.toString():"",title:angular.isDefined(t.designation)?t.designation:"",brand:{common:{title:L(t.product)}},family:angular.isDefined(t.product.common.family)?t.product.common.family:"",subfamily:angular.isDefined(t.product.common.subfamily)?t.product.common.subfamily:"",color:angular.isDefined(t.product.common.color)?t.product.common.color:"",reference:angular.isDefined(t.product.common.reference)?t.product.common.reference:"",last:angular.isDefined(t.product.common.MOD_05)?t.product.common.MOD_05:""},stock:{sku:angular.isDefined(t.codeSKU)?t.codeSKU:""},price:{valueWithTax:angular.isDefined(t.unitAmountWithTaxes)?t.unitAmountWithTaxes:0},quantity:angular.isDefined(t.quantity)?t.quantity:0}}return i=angular.element("#google-tag-manager").data("identifier"),r=u.getObject(n)||null,a=E(),{addCallback:function(t){b("eventCallback",(function(){document.location=t}))},addCartData:function(t){try{var e=k();angular.isDefined(e)&&this.setCartData(e,t)}catch(t){console.error("Unable to addCartData",t),o=!0}},addPageContext:function(){if(window.__change.gtm||!window.__change.gtm.contextData){var t=window.__change.gtm.contextData;$("pageStatus"),"logged"===t.mdUserLogged?(b("mdUserLogged",t.mdUserLogged),b("mdUserId",t.mdUserID.toString()),b("mdUserMail",t.mdUserMail),b("mdUserStatus",t.mdUserStatus),t.mdUserAddress&&b("mdUserAddress",t.mdUserAddress),t.mdUserLastConnexion&&b("mdUserLastConnexion",t.mdUserLastConnexion)):b("mdUserLogged",t.mdUserLogged),t.mdUserTargetIdentifier&&b("mdUserTargetIdentifier",t.mdUserTargetIdentifier),t.mdPageCategory1&&b("mdPageCategory1",t.mdPageCategory1),t.mdPageCategory2&&b("mdPageCategory2",t.mdPageCategory2),t.mdPageCategory3&&b("mdPageCategory3",t.mdPageCategory3),t.mdPageCategoryId1&&b("mdPageCategoryId1",t.mdPageCategoryId1),t.mdPageCategoryId2&&b("mdPageCategoryId2",t.mdPageCategoryId2),t.mdPageCategoryId3&&b("mdPageCategoryId3",t.mdPageCategoryId3),w()}},addPageCategory:function(){if(window.__change.gtm||!window.__change.gtm.contextData){var t=window.__change.gtm.contextData;(c.dataLayer=c.dataLayer||[]).push({user_logged:t.user_logged,user_mail:t.user_email,page_category:t.page_category})}},addProductCart:function(t,e){try{$("addToCart"),A({currencyCode:e}),this.setProductData(this.transformCartProduct(t),"add")}catch(t){console.error("Unable to push the dataLayer for addProductCart",t),o=!0}w()},addUtmVars:F,addVars:b,checkEcomType:S,getBlockConsentId:d,getCartData:k,getCurrencyCode:x,getDeliveryTypeTitle:function(t){switch(t){case"atHome":case"relay":return"En livraison";case"store":return"Retrait en magasin";case"reservation":return"Reservation gratuite en magasin";default:return""}},getGtmId:m,getHasCurrentPageTracked:g,getLineByKey:function(t,e){var a=null;return angular.forEach(t,(function(t){t.key===e&&(a=t)})),a},getLocalData:p,getNextImpressionsPosition:P,getProductBrand:L,getServiceCheck:f,getServiceLoaded:y,loadGtm:T,purchaseFailed:function(t,e){try{$("purchaseFailed"),angular.forEach(t.deliveries,(function(t){angular.forEach(t.lines,(function(t){t.key,U(M(t),"failed")}))})),b("errors",e)}catch(t){console.error("Unable to purchaseFailed",t),o=!0}w()},pushDataLayer:w,removeProductCart:function(t){try{A({currencyCode:x()}),this.setProductData(this.transformCartProduct(t),"remove"),$("removeFromCart")}catch(t){console.error("Unable to push the dataLayer for removeProductCart",t),o=!0}w()},setCartData:function(e,a){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var i=[];e.lines?i=e.lines:e.deliveries&&angular.forEach(e.deliveries,(function(e){var a;angular.forEach(e.lines,(function(t){t.deliveryCategory=e.category})),(a=i).push.apply(a,t(e.lines))})),angular.forEach(i,(function(t){r?I(t,a):n.setProductData(n.transformCartProduct(t),a)}))}catch(t){console.error("Unable to set cart data for ".concat(a),t),o=!0}},setCustomerDataFromCart:function(t,e,n){var o,r,i,c,s,u,l,d,g,m,p,f,y,h;S(n,!1),document.querySelector("#google-tag-manager").dataset.sendCustomerInPurchase&&t&&e.address&&(a.ecommerce[n].user_email=null===(o=t.customer)||void 0===o?void 0:o.email,a.ecommerce[n].user_phone=null===(r=t.customer.options)||void 0===r||null===(i=r.profiles.Rbs_User)||void 0===i?void 0:i.phone,a.ecommerce[n].user_firstname=null===(c=t.customer.options)||void 0===c||null===(s=c.profiles.Rbs_User)||void 0===s?void 0:s.firstName,a.ecommerce[n].user_lastname=null===(u=t.customer.options)||void 0===u||null===(l=u.profiles.Rbs_User)||void 0===l?void 0:l.lastName,"atHome"===e.category&&(a.ecommerce[n].user_zipcode=null===(d=e.address.fields)||void 0===d?void 0:d.zipCode,a.ecommerce[n].user_city=null===(g=e.address.fields)||void 0===g?void 0:g.locality,a.ecommerce[n].user_country=null===(m=e.address.fields)||void 0===m?void 0:m.countryCode,a.ecommerce[n].user_postal=null===(p=e.address.fields)||void 0===p?void 0:p.zipCode,a.ecommerce[n].user_street=null===(f=e.address.fields)||void 0===f?void 0:f.street,a.ecommerce[n].user_region=(null===(y=e.address.fields)||void 0===y?void 0:y.province)||(null===(h=e.address.fields)||void 0===h?void 0:h.state)))},setEncryptedCustomerEmail:function(t,e){if(S(e,!1),"undefined"!=typeof CryptoJS){var n=document.querySelector("#google-tag-manager").dataset.sendCustomerEmail;t&&t.customer.email&&n&&(a.ecommerce[e].customerEmailMD5=CryptoJS.MD5(t.customer.email).toString())}},setOrderLinesData:I,setCheckoutOption:function(t){$("checkoutOption"),A({currencyCode:x()}),R(t,"checkout_option"),w()},setEcomOption:A,setEcomTypeOption:R,setEvent:$,setHasCurrentPageTracked:h,setProductData:U,setServiceCheck:v,setServiceLoaded:D,trackCurrentPage:function(){document.querySelector("#google-tag-manager").dataset.bypassConsent&&!s?T():(r=u.getObject(n)||null,$("consents"),r&&u.isAccepted("analytics")&&(T(),s&&(b("consent_technical",r.acceptedCookies.technical),b("consent_analytical",r.acceptedCookies.analytics),b("consent_advertising",r.acceptedCookies.advertising),F(),w())))},transformCartProduct:M}}]}))}()}},e={};function a(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,a),r.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";a(440),a(666),a(681),a(714),a(353),a(318),a(740),a(297),a(733),a(579)})()})();